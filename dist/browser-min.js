// Browser.js 0.1.1
//
// Copyright (c) 2004 â€“ 2016 Web Semantics,Inc. All rights reserved.
//
// http://www.opensource.org/licenses/mit-license.php
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// build: 2016-03-24

function DOMNode(){var a=DOMNode.arguments;DOMNode.length;this.className="DOMNode",this.nodeName=null,this.nodeValue=null,this.attributes=null,this.children=null,this.namespacePrefix=null,this.namespaceURI=null,this.nodeType=null,this.document=null,this.parentNode=null,this.previousNode=null,this.nextNode=null,a.length>=0&&this.initDOMNode()}function CharacterData(){var a=CharacterData.arguments;CharacterData.length;this.className="CharacterData",this.data=null,a.length>=0&&this.initCharacterData()}function Attributes(a,b,c){var d=Attributes.arguments;Attributes.length;this.className="Attributes",this.listOfAttributes=["border-style","border-right-width","border-left-width","border-top-width","border-bottom-width","text-decoration","href","alt","mathcolor","mathbackground","mathsize","mathvariant","background-color","fontweight","linethickness","text-align","width","height","src","form","fence","separator","accent","lspace","rspace","stretchy","symmetric","maxsize","minsize","largeop","movablelimits","depth","lquote","rquote"],this.inhAttributes=["fontfamily","fontsize","fontstyle","color"],this.defaultAttributes=null,d.length>0&&this.initAttributes(a,b,c)}function Box(a,b,c,d){var e=Box.arguments;Box.length;this.className="Box",this.baseline=0,this.fColor="black",this.bgColor=null,this.created=!1,this.Node=null,this.bgNode=null,e.length>0&&this.initBox(a,b,c,d)}function CSSBox(){var a=CSSBox.arguments;CSSBox.length;this.className="CSSBox",this.bgColor=null,this.border_color_top="rgb(64,64,64)",this.border_color_bottom="rgb(128,128,128)",this.border_color_left="rgb(212,208,200)",this.border_color_right="rgb(230,230,230)",this.padding_left=0,this.padding_right=0,this.padding_top=0,this.padding_bottom=0,this.border_left_width=0,this.border_right_width=0,this.border_top_width=0,this.border_bottom_width=0,this.margin_left=0,this.margin_right=0,this.margin_top=0,this.margin_bottom=0,this.border_style="none",this.bgg=null,this.backgroundRect=null,this.borderTopPolygon=null,this.borderRightPolygon=null,this.borderBottomPolygon=null,this.borderLeftPolygon=null,a.length>=0&&this.initCSSBox()}function TextData(a,b){var c=TextData.arguments;TextData.length;this.className="TextData",this.data=null,this.font=null,this.space=0,this.left=0,this.right=0,this.fontfamily="Times New Roman",this.fontstyle="normal",this.fontsize=14,c.length>0&&this.initTextData(a,b)}function MathML(a){var b=MathML.arguments;MathML.length;this.className="MathML",this.child=null,this.initMathML=function(a){this.initCSSBox(),this.child=a,this.setCSSBox(5,5,5,5,0,0,0,0,0,0,0,0)},this.paint=function(a,b,c){this.paintMathML(a,b,c)},this.paintMathML=function(b,c,d){this.paintBox(b,c,d),null!=this.child&&a.paint(b,c,d)},this.recalc=function(){this.recalcMathML()},this.recalcMathML=function(){return null==this.child?!1:(this.child.recalc(),this.setInnerWidth(this.child.getWidth()),this.setInnerHeight(this.child.getHeight()),this.setBaseline(this.child.getBaseline()),void this.recalcCSSBox())},this.moveContentTo=function(a,b){this.moveContentToMathML(a,b)},this.moveContentToMathML=function(a,b){this.moveContentToBox(a,b),a+=this.getDx(),b+=this.getDy(),null!=this.child&&this.child.moveTo(a,b)},b.length>0&&this.initMathML(a)}function Html(){}function cloneObject(a){for(var b in a)"object"==typeof a[b]?this[b]=new cloneObject(a[b]):this[b]=a[b]}function Css(){}function CSSSelectorDefinition(){this.me=""}function Browserjs(){var a=(Browserjs.arguments,Browserjs.length,"http://www.w3.org/1999/xhtml");this.className="Browserjs",this.documents=new Vector,this.parse=function(){nl=svgDocument.getElementsByTagNameNS(a,"html");for(var b=0;b<nl.length;b++){var c=nl.item(b),d=new Attributes(c,!0);c.setAttribute("style",d.getStyle()),this.documents.addElement(new Browserjs.Document(c,this))}this.paint(),this.recalc()},this.draw=function(a){this.paint(a)},this.paint=function(a){for(var b=new Enumerator(this.documents);b.hasMoreElements();)b.nextElement().paint(a)},this.recalc=function(){for(var a=new Enumerator(this.documents);a.hasMoreElements();)a.nextElement().recalc()}}var ELEMENT_NODE=1,ATTRIBUTE_NODE=2,TEXT_NODE=3,CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=5,ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=8,DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=12;DOMNode.prototype.initDOMNode=function(){},DOMNode.prototype.getNodeName=function(){return null!=this.namespacePrefix?this.namespacePrefix+":"+this.nodeName:this.nodeName},DOMNode.prototype.setNodeValue=function(a){this.nodeValue=a},DOMNode.prototype.getNodeValue=function(){return this.nodeValue},DOMNode.prototype.getNodeType=function(){return this.nodeType},DOMNode.prototype.getParentNode=function(){return this.parentNode},DOMNode.prototype.getChildNodes=function(){return new DOMNodeList(this.children)},DOMNode.prototype.getFirstChild=function(){return this.children.isEmpty()?null:this.children.elementAt(0)},DOMNode.prototype.getLastChild=function(){return this.children.isEmpty()?null:this.children.elementAt(this.children.size()-1)},DOMNode.prototype.getPreviousSibling=function(){return this.previousNode},DOMNode.prototype.getNextSibling=function(){return this.nextNode},DOMNode.prototype.getAttributes=function(){return this.attributes},DOMNode.prototype.getOwnerDocument=function(){return this.document},DOMNode.prototype.insertBefore=function(a,b){if(null==a)return null;null==this.children&&(this.children=new Vector),this.children.removeElement(a);var c=this.children.indexOf(b);return-1==c||null==b?this.children.addElement(a):this.children.insertElementAt(a,c-1),a},DOMNode.prototype.replaceChild=function(a,b){if(null==a||null==this.children)return null;this.children.removeElement(a);var c=this.children.indexOf(b);return-1==c||null==b?this.children.addElement(a):(this.children.removeElement(b),this.children.insertElementAt(a,c)),b},DOMNode.prototype.removeChild=function(a){return null==a||null==this.children?null:(this.children.removeElement(a),a)},DOMNode.prototype.appendChild=function(a){return null==a||null==this.children?null:(this.children.addElement(a),a)},DOMNode.prototype.hasChildNodes=function(){return null==this.children?!1:!this.children.isEmpty()},DOMNode.prototype.cloneNode=function(a){alert("DOMNode.prototype.cloneNode is NOT supported")},DOMNode.prototype.normalize=function(){alert("DOMNode.prototype.normalize is NOT supported")},DOMNode.prototype.isSupported=function(a,b){alert("DOMNode.prototype.isSupported is NOT supported")},DOMNode.prototype.getNamespaceURI=function(){return this.namespaceURI},DOMNode.prototype.getPrefix=function(){return this.namespacePrefix},DOMNode.prototype.setPrefix=function(a){this.namespacePrefix=a},DOMNode.prototype.getLocalName=function(){return this.nodeName},DOMNode.prototype.hasAttributes=function(){return!(null==this.attributes)},CharacterData.prototype=new DOMNode,CharacterData.prototype.initCharacterData=function(){},CharacterData.prototype.getData=function(){return this.data},CharacterData.prototype.setData=function(a){this.data=a},CharacterData.prototype.getLength=function(){return null==this.data?0:this.data.length},CharacterData.prototype.substringData=function(a,b){return 0>a||a>this.getLength()||0>b?void alert("substringData:substringData[71]: Error"):null==this.data?"":this.data.substring(a,a+b)},CharacterData.prototype.appendData=function(a){null!=this.data&&(this.data+=a)},CharacterData.prototype.insertData=function(a,b){null!=this.data&&(this.data=this.data.substring(0,a)+b+this.data.substring(a,this.data.length))},CharacterData.prototype.deleteData=function(a,b){null!=this.data&&(this.data=this.data.substring(0,a)+this.data.substring(a+b,this.data.length))},CharacterData.prototype.replaceData=function(a,b,c){null!=this.data&&(this.data=this.data.substring(0,a)+c+this.data.substring(a+b,this.data.length))},CharacterData.prototype.toString=function(){return this.data},Attributes.prototype.initAttributes=function(a,b,c){void 0==b&&(b=!1),void 0!=c?this.defaultAttributes=c:this.defaultAttributes="                                  href:null;                                  text-decoration:none;                                  fontfamily:Arial Narrow;                                  fontsize:14;                                  color:black;                                  alt:insert text here;                                  fontstyle:normal;                                  background-color:none;                                  fontweight:normal;                                  linethickness:1;                                  text-align:left;                                  width:10;                                  mathvariant:normal;                                  mathsize:small;                                  mathbackground:none;                                  mathcolor:black;                                  height:10;                                  form:null;                                  fence:false;                                  separator:false;                                  accent:null;                                  lspace:0;                                  rspace:0;                                  stretchy:null;                                  symmetric:true;                                  maxsize:infinity;                                  minsize:0;                                  largeop:null;                                  movablelimits:null;                                  depth:0;                                  rquote:rq;                                  lquote:lq;                                  padding-bottom:0;                                  padding-left:0;                                  padding-right:0;                                  border-bottom-width:0;                                  border-top-width:0;                                  border-left-width:0;                                  border-right-width:0;                                  border-style:none;                                  font-weight:normal;                                  padding-top:0;",this.resolveCSSStyle(a,b),this.obtainAttributes(a)},Attributes.prototype.resolveCSSStyle=function(a,b){var c=a.getAttribute("style");if(null!=c&&""!=c){for(var d=this.listOfAttributes,e=c.split(";"),f=new Object,g=0;g<e.length;g++){var h=e[g].split(":");null!=h[0]&&""!=h[0]&&(f[h[0]]=h[1])}var i=null,j=null;if(b)for(var i=this.defaultAttributes.split(";"),j=new Object,g=0;g<i.length;g++){var h=i[g].split(":");null!=h[0]&&""!=h[0]&&(j[h[0]]=h[1])}for(var g=0;g<d.length;g++){var k=d[g],l=f[k];void 0==l&&b&&(l=j[k]),this[k.replace("-","_")]=l}d=this.inhAttributes;for(var g=0;g<d.length;g++){var k=d[g],l=f[k];void 0==l&&b&&(l=j[k]),this[k.replace("-","_")]=l}}},Attributes.prototype.obtainAttributes=function(a){if(void 0!=a&&null!=a){for(var b=this.listOfAttributes,c=0;c<b.length;c++){var d=b[c],e=a.getAttribute(d);e&&e.length>0&&(this[d.replace("-","_")]=e)}b=this.inhAttributes;for(var c=0;c<b.length;c++){var d=b[c],e=a.getAttribute(d);e&&e.length>0&&(this[d.replace("-","_")]=e)}}},Attributes.prototype.getStyle=function(a){var b=this.inhAttributes,c="";for(i=0;i<b.length;i++)void 0!=this[b[i]]&&(c+=b[i]+":"+this[b[i]]+";");return c},Attributes.prototype.toString=function(){var a=this.inhAttributes,b="";for(i=0;i<a.length;i++){var c=a[i].replace("-","_");this[c]&&(b+="  "+c+":"+this[c])}for(a=this.listOfAttributes,b+="\n -------------------------- \n",i=0;i<a.length;i++){var c=a[i].replace("-","_");this[c]&&(b+="  "+c+" : "+this[c])}return b},Box.prototype=new Node,Box.prototype.initBox=function(a,b,c,d){this.initNode(a,b,c,d,0,1)},Box.prototype.setBaseline=function(a){this.baseline=a},Box.prototype.getBaseline=function(){return this.baseline},Box.prototype.setColor=function(a){this.setColorBox(a)},Box.prototype.setColorBox=function(a){this.fColor=a||"black",null!=this.Node&&void 0!=this.Node.setColor&&this.Node.setColor(this.fColor)},Box.prototype.setBackgroundColor=function(a){return this.bgColor=a||null,null==this.bgColor&&null!=this.bgNode?void this.bgNode.dispose():void(null!=this.bgNode&&this.bgNode.setColor(this.bgColor))},Box.prototype.draw=function(a,b,c,d,e){this.setCoord(a,b),this.paint(c,d,e)},Box.prototype.paint=function(a,b,c){this.paintBox(a,b,c)},Box.prototype.paintBox=function(a,b,c){this.created?(void 0==a||null==this.Node||void 0!=c&&null!=c||a.addGraphics(this.Node),void 0!=b&&null!=this.bgNode&&b.addGraphics(this.bgNode)):(this.created=!0,this.createSVGContent(a,b,c))},Box.prototype.createSVGContent=function(a,b,c){this.createSVGContentBox(a,b,c)},Box.prototype.createSVGContentBox=function(a,b,c){null!=this.bgColor&&(this.bgNode=b.drawRect(this.x,this.y,this.getWidth(),this.getHeight()),this.setBackgroundColor(this.bgColor))},Box.prototype.scale=function(a){},Box.prototype.recalc=function(){this.recalcBox()},Box.prototype.recalcBox=function(){null!=this.bgNode&&this.bgNode.setSize(this.getWidth(),this.getHeight()),this.moveTo(this.x,this.y)},Box.prototype.moveTo=function(a,b){this.setCoord(a,b),this.moveContentTo(a,b),this.moveBackgroundTo(a,b)},Box.prototype.moveContentTo=function(a,b){this.moveContentToBox(a,b)},Box.prototype.moveContentToBox=function(a,b){null!=this.Node&&this.Node.translate(a,b+this.getBaseline())},Box.prototype.moveBackgroundTo=function(a,b){null!=this.bgNode&&this.bgNode.translate(a,b)},Box.prototype.setAttributes=function(a,b){this.setAttributesBox(a,b)},Box.prototype.setAttributesBox=function(a,b){if(void 0==a)return!1;var c=a.inhAttributes;for(i=0;i<c.length;i++){var d=c[i].replace("-","_");void 0!=a[d]?this[d]=a[d]:void 0!=b&&(this[d]=b[d])}var e=a.defaultAttributes;for(i=0;i<e.length;i++){var d=e[i].replace("-","_");void 0!=a[d]&&(this[d]=a[d])}return this.setColor(this.color),this.setBackgroundColor(a.background_color),!0},Box.prototype.toString=function(){return this.toStringBox()},Box.prototype.toStringBox=function(){return this.className+":\n [baseline:"+this.baseline+", color:"+this.fColor+", background:"+this.bgColor+"]\n [x:"+this.x+", y:"+this.y+", width:"+this.w+", height:"+this.h+"]"},CSSBox.prototype=new Box,CSSBox.prototype.initCSSBox=function(){this.initNode(0,0,0,0,0,1),this.setCSSBox(5,5,5,5,3,3,3,3,2,2,2,2)},CSSBox.prototype.setCSSBox=function(a,b,c,d,e,f,g,h,i,j,k,l){this.padding_left=a,this.padding_right=b,this.padding_top=c,this.padding_bottom=d,this.border_left_width=e,this.border_right_width=f,this.border_top_width=g,this.border_bottom_width=h,this.margin_left=i,this.margin_right=j,this.margin_top=k,this.margin_bottom=l},CSSBox.prototype.setBorderColor=function(a,b,c,d){this.border_color_top=a,this.border_color_right=b,this.border_color_bottom=c,this.border_color_left=d},CSSBox.prototype.getInnerWidth=function(){return this.w-(this.margin_right+this.border_right_width+this.padding_right)-(this.margin_left+this.border_left_width+this.padding_left)},CSSBox.prototype.getInnerHeight=function(){return this.h-(this.margin_top+this.border_top_width+this.padding_top)-(this.margin_bottom+this.border_bottom_width+this.padding_bottom)},CSSBox.prototype.setInnerHeight=function(a){this.h=a+(this.margin_top+this.border_top_width+this.padding_top)+(this.margin_bottom+this.border_bottom_width+this.padding_bottom)},CSSBox.prototype.setInnerWidth=function(a){this.w=a+(this.margin_right+this.border_right_width+this.padding_right)+(this.margin_left+this.border_left_width+this.padding_left)},CSSBox.prototype.getDx=function(){return this.margin_right+this.border_right_width+this.padding_right},CSSBox.prototype.getDy=function(){return this.margin_top+this.border_top_width+this.padding_top},CSSBox.prototype.getBColor=function(a){return null!=a?a:null!=this.border_color_top?this.border_color_top:null!=this.border_color_right?this.border_color_right:null!=this.border_color_bottom?this.border_color_bottom:null!=this.border_color_left?this.border_color_left:this.fColor},CSSBox.prototype.createSVGContent=function(a,b,c){this.createSVGContentCSSBox(a,b,c)},CSSBox.prototype.createSVGContentCSSBox=function(a,b,c){this.bgg=new Graphics(0,0,0,0),b.addGraphics(this.bgg),b=this.bgg,this.bgNode=b,null!=this.bgColor&&(this.backgroundRect=b.drawRect(0,0,0,0),this.setBackgroundColor(this.bgColor)),"solid"==this.border_style&&(this.borderTopPolygon=b.drawPolygon(0,0),this.borderRightPolygon=b.drawPolygon(0,0),this.borderBottomPolygon=b.drawPolygon(0,0),this.borderLeftPolygon=b.drawPolygon(0,0))},CSSBox.prototype.recalc=function(){this.recalcCSSBox()},CSSBox.prototype.recalcCSSBox=function(){var a=this.getWidth(),b=this.getHeight(),c=this.getDx(),d=this.getDy(),e=(this.getInnerWidth(),this.getInnerHeight(),0),f=0,g=this.padding_left,h=this.padding_right,i=this.padding_top,j=this.padding_bottom,k=this.border_left_width,l=this.border_right_width,m=this.border_top_width,n=this.border_bottom_width,o=this.margin_left,p=this.margin_right,q=this.margin_top,r=this.margin_bottom;null!=this.backgroundRect&&(this.backgroundRect.setSize(this.getInnerWidth()+g+h,this.getInnerHeight()+i+j),this.backgroundRect.translate(e+c-g,f+d-i),this.backgroundRect.setColor(this.bgColor));var s=e+o,t=s+k,u=f+q,v=u+m,w=e+a-p,x=w-l,y=f+q,z=y+m,A=e+o,B=s+k,C=f+b-r,D=C-n,E=e+a-p,F=w-l,G=f+b-r,H=C-n,I=[s,t,x,w],J=[u,v,z,y],K=[w,x,F,E],L=[y,z,H,G],M=[E,F,B,A],N=[G,H,D,C],O=[A,B,t,s],P=[C,D,v,u];null!=this.borderTopPolygon&&(this.borderTopPolygon.setXYPoints(I,J),this.borderTopPolygon.setColor(this.getBColor(this.border_color_top))),null!=this.borderRightPolygon&&(this.borderRightPolygon.setXYPoints(K,L),this.borderRightPolygon.setColor(this.getBColor(this.border_color_right))),null!=this.borderBottomPolygon&&(this.borderBottomPolygon.setXYPoints(M,N),this.borderBottomPolygon.setColor(this.getBColor(this.border_color_bottom))),null!=this.borderLeftPolygon&&(this.borderLeftPolygon.setXYPoints(O,P),this.borderLeftPolygon.setColor(this.getBColor(this.border_color_left))),this.recalcBox()};var fontUnit="pt";TextData.prototype=new Box,TextData.prototype.initTextData=function(a,b){this.initBox(0,0,0,0);var c=8290;void 0!=a&&null!=a&&a.charCodeAt(0)!=c&&(this.data=a),this.setAttributes(b)},TextData.prototype.getWidth=function(){return this.w+this.left+this.right},TextData.prototype.createSVGContent=function(a,b,c){this.createSVGContentTextData(a,b,c)},TextData.prototype.createSVGContentTextData=function(a,b,c){if(null!=this.data){this.createSVGContentBox(a,b);var d=void 0!=c&&null!=c?"tspan":"text";this.font=new Font(this.fontfamily,this.fontstyle,this.fontsize+fontUnit),a.setFont(this.font),a.setColor(this.fColor),this.Node=a.drawText(this.x+this.left,this.y+this.top+this.getBaseline(),this.data,d,c),this.Node.removeAttribute("transform")}},TextData.prototype.scale=function(a){if(null!=this.font){var b=this.font.getSizeValue()*a;this.font.setSize(b+fontUnit),this.Node.setFont(this.font)}else this.fontsize*=a},TextData.prototype.moveContentTo=function(a,b){null!=this.Node&&(this.Node.setAttribute("x",a+this.left),this.Node.setAttribute("y",b+this.getBaseline()))},TextData.prototype.recalc=function(){this.recalcTextData()},TextData.prototype.recalcTextData=function(){return null==this.data||null==this.getNode()?!1:(this.space=new FontMetrics(this.font).getStringWidth("-"),this.getNode().setFont(this.font),this.setBaseline(this.getNode().getBaseline()),this.setWidth(this.getNode().getStringWidth()),this.setHeight(this.getNode().getStringHeight()),void this.recalcBox())},TextData.prototype.toString=function(){return this.toStringBox()+"\n [data:"+this.data+", font:"+this.font+"]"};var scaleSup=.4,scaleSub=.4,subLoc=.6,supLoc=.3,scaleFraction=.8;MathML.prototype=new CSSBox,MathML.Mo=function(a,b){MathML.Mo.arguments,MathML.Mo.length;this.className="MathMl.Mo",this.initTextData(a,b)},MathML.Mo.prototype=new TextData,MathML.Mi=function(a,b){MathML.Mi.arguments,MathML.Mi.length;this.className="MathMl.Mi",this.initTextData(a,b),1==a.length&&(this.fontstyle="italic")},MathML.Mi.prototype=new TextData,MathML.Mn=function(a,b){MathML.Mn.arguments,MathML.Mn.length;this.className="MathMl.Mn",this.initTextData(a,b)},MathML.Mn.prototype=new TextData,MathML.Under=function(a,b){var c=MathML.Under.arguments;MathML.Under.length;this.className="MathML.Under",this.base=null,this.under=null,this.initUnder=function(a,b){this.initBox(0,0,0,0),this.base=a,this.under=b},this.setColor=function(a){this.setColorBox(a),this.base.setColor(a),this.under.setColor(a)},this.paint=function(a,b,c){this.paintUnder(a,b,c)},this.paintUnder=function(a,b,c){this.paintBox(a,b,c),this.base.paint(a,b,c),this.under.paint(a,b,c)},this.recalc=function(){this.recalcUnder()},this.recalcUnder=function(){this.base.recalc(),this.under.recalc(),this.setWidth(Math.max(this.base.getWidth(),this.under.getWidth())),this.setHeight(this.base.getHeight()+this.under.getHeight()),this.setBaseline(this.base.getBaseline()),this.base.moveTo(this.x+(this.getWidth()-this.base.getWidth())/2,this.y),this.under.moveTo(this.x+(this.getWidth()-this.under.getWidth())/2,this.y+this.base.getHeight()),this.recalcBox()},this.scale=function(a){this.base.scale(a),this.under.scale(a),this.recalc()},this.toString=function(){return this.toStringBox()+"\n"+this.base+"\n"+this.under},c.length>0&&this.initUnder(a,b)},MathML.Under.prototype=new Box,MathML.Over=function(a,b){var c=MathML.Over.arguments;MathML.Over.length;this.className="MathML.Over",this.base=null,this.over=null,this.initOver=function(a,b){this.initBox(0,0,0,0),this.base=a,this.over=b},this.setColor=function(a){this.setColorBox(a),this.base.setColor(a),this.over.setColor(a)},this.paint=function(a,b,c){this.paintOver(a,b,c)},this.paintOver=function(a,b,c){this.paintBox(a,b,c),this.base.paint(a,b,c),this.over.paint(a,b,c)},this.recalc=function(){this.recalcOver()},this.recalcOver=function(){this.base.recalc(),this.over.recalc(),this.setWidth(Math.max(this.base.getWidth(),this.over.getWidth())),this.setHeight(this.base.getHeight()+this.over.getHeight()),this.setBaseline(this.base.getBaseline()+this.over.getHeight()),this.base.moveTo(this.x+(this.getWidth()-this.base.getWidth())/2,this.y+this.over.getHeight()),this.over.moveTo(this.x+(this.getWidth()-this.over.getWidth())/2,this.y),this.recalcBox()},this.scale=function(a){this.base.scale(a),this.over.scale(a),this.recalc()},this.toString=function(){return this.toStringBox()+"\n"+this.base+"\n"+this.over},c.length>0&&this.initOver(a,b)},MathML.Over.prototype=new Box,MathML.Sub=function(a,b){var c=MathML.Sub.arguments;MathML.Sub.length;this.className="MathML.Sub",this.base=null,this.subScript=null,this.initSub=function(a,b){this.initBox(0,0,0,0),this.base=a,this.subScript=b,this.subScript.scale(scaleSub)},this.setColor=function(a){this.setColorBox(a),this.base.setColor(a),this.subScript.setColor(a)},this.paint=function(a,b,c){this.paintSub(a,b,c)},this.paintSub=function(a,b,c){this.paintBox(a,b,c),this.base.paint(a,b,c),this.subScript.paint(a,b,c)},this.recalc=function(){this.recalcSub()},this.recalcSub=function(){this.base.recalc(),this.subScript.recalc(),this.setWidth(this.base.getWidth()+this.subScript.getWidth()),this.setHeight(Math.max(this.base.getHeight(),this.base.getHeight()*subLoc+this.subScript.getHeight())),this.setBaseline(this.base.getBaseline()),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToSub(a,b)},this.moveContentToSub=function(a,b){this.moveContentToBox(a,b),this.base.moveTo(a,b),this.subScript.moveTo(a+this.base.getWidth(),b+this.base.getHeight()*subLoc)},this.scale=function(a){this.base.scale(a),this.subScript.scale(a),this.recalc()},this.toString=function(){return this.toStringBox()+"\n"+this.base+"\n"+this.subScript},c.length>0&&this.initSub(a,b)},MathML.Sub.prototype=new Box,MathML.Sup=function(a,b){var c=MathML.Sup.arguments;MathML.Sup.length;this.className="MathML.Sup",this.base=null,this.supScript=null,this.initSup=function(a,b){this.initBox(0,0,0,0),this.base=a,this.supScript=b,this.supScript.scale(scaleSup)},this.setColor=function(a){this.setColorBox(a),this.base.setColor(a),this.supScript.setColor(a)},this.paint=function(a,b,c){this.paintSup(a,b,c)},this.paintSup=function(a,b,c){this.paintBox(a,b,c),this.base.paint(a,b,c),this.supScript.paint(a,b,c)},this.recalc=function(){this.recalcSup()},this.recalcSup=function(){this.base.recalc(),this.supScript.recalc(),this.setWidth(this.base.getWidth()+this.supScript.getWidth()),this.setHeight(Math.max(this.base.getHeight(),this.base.getHeight()*(1-supLoc)+this.supScript.getHeight())),this.setBaseline(this.base.getBaseline()),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToSup(a,b)},this.moveContentToSup=function(a,b){this.moveContentToBox(a,b);var c=b-this.supScript.getHeight()+this.base.getHeight()*supLoc,d=b;b>c&&(this.setBaseline(this.base.getBaseline()+(b-c)),d+=b-c,c+=b-c),this.base.moveTo(a,d),this.supScript.moveTo(a+this.base.getWidth(),c)},this.scale=function(a){this.base.scale(a),this.supScript.scale(a),this.recalc()},this.toString=function(){return this.toStringBox()+"\n"+this.base+"\n"+this.supScript},c.length>0&&this.initSup(a,b)},MathML.Sup.prototype=new Box,MathML.SupSub=function(a,b,c){var d=MathML.SupSub.arguments;MathML.SupSub.length;this.className="MathML.SupSub",this.base=null,this.supScript=null,this.subScript=null,this.initSupSub=function(a,b,c){this.initBox(0,0,0,0),this.base=a,this.supScript=b,this.subScript=c,this.supScript.scale(scaleSup),this.subScript.scale(scaleSub)},this.setColor=function(a){this.setColorBox(a),this.base.setColor(a),this.supScript.setColor(a),this.subScript.setColor(a)},this.paint=function(a,b,c){this.paintSupSub(a,b,c)},this.paintSupSub=function(a,b,c){this.paintBox(a,b,c),this.base.paint(a,b,c),this.supScript.paint(a,b,c),this.subScript.paint(a,b,c)},this.recalc=function(){this.recalcSupSub()},this.recalcSupSub=function(){this.base.recalc(),this.supScript.recalc(),this.subScript.recalc(),this.supScript.recalc();var a=this.base.getWidth()+this.supScript.getWidth(),b=Math.max(this.base.getHeight(),this.base.getHeight()*(1-supLoc)+this.supScript.getHeight()),c=this.base.getBaseline(),d=this.y-this.supScript.getHeight()+this.base.getHeight()*supLoc;if(d<this.y){var e=this.y-d;c=this.base.getBaseline()+e,d+=e}var f=this.base.getWidth()+this.subScript.getWidth();this.setWidth(Math.max(a,f)),this.setHeight(Math.max(b,b-this.base.getHeight()*(1-subLoc)+this.subScript.getHeight())),this.setBaseline(c),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToSupSub(a,b)},this.moveContentToSupSub=function(a,b){this.moveContentToBox(a,b);var c=this.y-this.supScript.getHeight()+this.base.getHeight()*supLoc,d=this.y;if(c<this.y){var e=this.y-c;d+=e,c+=e}this.base.moveTo(a,d),this.supScript.moveTo(a+this.base.getWidth(),c),this.subScript.moveTo(a+this.base.getWidth(),d+this.base.getHeight()*subLoc)},this.scale=function(a){this.base.scale(a),this.supScript.scale(a),this.subScript.scale(a),this.recalc()},this.toString=function(){return this.toStringBox()+"\n"+this.base+"\n"+this.supScript+"\n"+this.subScript},d.length>0&&this.initSupSub(a,b,c)},MathML.SupSub.prototype=new Box,MathML.Frac=function(a,b,c){var d=MathML.Frac.arguments;MathML.Frac.length;this.className="MathML.Frac",this.numerator=null,this.denominator=null,this.iscale=1/(new FontMetrics).pt2px,this.linethickness=1,this.initFrac=function(a,b,c){this.initBox(0,0,0,0),this.numerator=a,this.denominator=b,this.numerator.scale(scaleFraction),this.denominator.scale(scaleFraction),this.setAttributes(c)},this.setAttributes=function(a){this.setAttributesBox(a)&&(void 0!=a.linethickness?this.linethickness=parseFloat(a.linethickness):this.linethickness=1)},this.setColor=function(a){this.setColorBox(a),this.numerator.setColor(a),this.denominator.setColor(a)},this.createSVGContent=function(a,b,c){this.createSVGContentFrac(a,b,c)},this.createSVGContentFrac=function(a,b,c){this.createSVGContentBox(a,b,c),a.setColor(this.fColor),this.Node=a.drawRect(this.x,this.y+this.numerator.getHeight()+this.iscale,this.getWidth(),this.linethickness)},this.paint=function(a,b,c){this.paintFrac(a,b,c)},this.paintFrac=function(a,b,c){this.paintBox(a,b,c),this.numerator.paint(a,b,c),this.denominator.paint(a,b,c)},this.recalc=function(){this.recalcFrac()},this.recalcFrac=function(){this.numerator.recalc(),this.denominator.recalc(),this.setWidth(Math.max(this.numerator.getWidth(),this.denominator.getWidth())),this.setHeight(this.numerator.getHeight()+this.denominator.getHeight()+2*this.iscale+this.linethickness),this.setBaseline(this.numerator.getHeight()+1*this.iscale+this.linethickness/2+.4*this.denominator.getHeight()),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToFrac(a,b)},this.moveContentToFrac=function(a,b){this.moveContentToBox(a,b),this.numerator.moveTo(a+(this.getWidth()-this.numerator.getWidth())/2,b),this.denominator.moveTo(a+(this.getWidth()-this.denominator.getWidth())/2,b+this.numerator.getHeight()+2*this.iscale+this.linethickness),null!=this.Node&&(this.setColor(this.fColor),this.Node.setSize(this.getWidth(),this.linethickness),this.Node.translate(a,b+this.numerator.getHeight()+this.iscale))},this.scale=function(a){this.numerator.scale(a),this.denominator.scale(a),this.iscale*=a/(new FontMetrics).pt2px,this.linethickness*=a,this.recalc()},this.toString=function(){return this.toStringBox()+"\n"+this.base+"\n"+this.supScript},d.length>0&&this.initFrac(a,b,c)},MathML.Frac.prototype=new Box,MathML.Sqrt=function(a,b){var c=MathML.Sqrt.arguments;MathML.Sqrt.length;this.className="MathML.Sqrt",this.row=null,this.linethickness=1,this.radicalSWidth=0,this.iscale=1,this.initSqrt=function(a,b){this.initBox(0,0,0,0),this.row=a,this.linethickness=b||2},this.setAttributes=function(a){this.setAttributesBox(a)&&(this.linethickness=a.linethickness?parseFloat(a.linethickness):1)},this.setColor=function(a){this.setColorBox(a),this.row.setColor(a)},this.createSVGContent=function(a,b,c){this.createSVGContentSqrt(a,b,c)},this.createSVGContentSqrt=function(a,b,c){this.createSVGContentBox(a,b,c),a.setColor(this.fColor),this.Node=a.drawPolygon(this.x,this.y)},this.paint=function(a,b,c){this.paintSqrt(a,b,c)},this.paintSqrt=function(a,b,c){this.paintBox(a,b,c),this.row.paint(a,b,c)},this.recalc=function(){this.recalcSqrt()},this.recalcSqrt=function(){this.row.recalc(),this.radicalSWidth=.53*this.row.getHeight(),this.setWidth(this.row.getWidth()+this.radicalSWidth),this.setHeight(this.row.getHeight()),this.setBaseline(this.row.getBaseline()),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToSqrt(a,b)},this.moveContentToSqrt=function(a,b){if(this.moveContentToBox(a,b),this.row.moveTo(a+this.radicalSWidth,b),null!=this.Node){var c=new Array,d=new Array,e=this.radicalSWidth,f=this.getHeight(),g=[0,.2771,.6747,.9277,1,1,1,1,.6887,.2108,.0421],h=[.4968,.414,.82,0,0,0,.0318,.0318,.9968,.4904,.5318],i=0;for(i=0;i<g.length;i++)c[i]=g[i]*e;for(i=0;i<h.length;i++)d[i]=h[i]*f;c[5]+=this.row.getWidth(),c[6]+=this.row.getWidth(),this.Node.translate(a,b),this.Node.setXYPoints(c,d),this.setColor(this.fColor)}},this.scale=function(a){this.iscale=a,this.linethickness*=a,this.row.scale(a),this.recalc()},this.toString=function(){return this.toStringBox()+"\n"+this.base+"\n"+this.subScript},c.length>0&&this.initSqrt(a,b)},MathML.Sqrt.prototype=new Box,MathML.Row=function(a){var b=MathML.Row.arguments;MathML.Row.length;this.className="MathML.Row",this.children=null,this.lines=null,this.initRow=function(a){this.initBox(0,0,0,0),this.children=new Vector,this.lines=new Vector,this.addChild(a)},this.addChild=function(a){var b=null;return void 0!=a&&null!=a&&(b=this.children.addElement(a)),this.recalc(),b},this.childAt=function(a){return this.children.elementAt(a)},this.getChildren=function(){return new Enumerator(this.children)},this.setColor=function(a){this.setColorBox(a);for(var b=this.getChildren();b.hasMoreElements();){var c=b.nextElement();c.setColor(a)}},this.paint=function(a,b,c){this.paintRow(a,b,c)},this.paintRow=function(a,b,c){this.paintBox(a,b,c);for(var d=this.getChildren();d.hasMoreElements();){
var e=d.nextElement();e.paint(a,b,c)}},this.recalc=function(){this.recalcRow()},this.recalcRow=function(){for(var a=this.getChildren();a.hasMoreElements();){var b=a.nextElement();b.recalc()}for(var c=0,d=0,e=0,a=this.getChildren();a.hasMoreElements();){var b=a.nextElement(),f=b.getBaseline(),g=b.getHeight()-f;g>Math.abs(d)&&(d=g),f>Math.abs(e)&&(e=f,this.setBaseline(b.getBaseline())),c+=b.getWidth()}this.setWidth(c),this.setHeight(d+e),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToRow(a,b)},this.moveContentToRow=function(a,b){this.moveContentToBox(a,b);for(var c=0,d=this.getChildren();d.hasMoreElements();){var e=d.nextElement();e.moveTo(a+c,b-e.getBaseline()+this.getBaseline()),c+=e.getWidth()}},this.scale=function(a){for(var b=this.getChildren();b.hasMoreElements();){var c=b.nextElement();c.scale(a)}this.recalc()},this.toString=function(){return this.toStringBox()},b.length>=0&&this.initRow(a)},MathML.Row.prototype=new Box,MathML.Fenced=function(a,b,c,d){var e=MathML.Fenced.arguments;MathML.Fenced.length;this.className="MathML.Fenced",this.row=null,this.sLeft=null,this.sRight=null,this.initFenced=function(a,b,c,d){this.initBox(0,0,0,0),this.sLeft=new TextData(b,d),this.sRight=new TextData(c,d),this.row=new MathML.Row(this.sLeft),this.row.addChild(a),this.row.addChild(this.sRight)},this.setColor=function(a){this.setColorBox(a),this.row.setColor(a)},this.paint=function(a,b,c){this.paintFenced(a,b,c)},this.paintFenced=function(a,b,c){this.paintBox(a,b,c),this.row.paint(a,b,c)},this.recalc=function(){this.recalcFenced()},this.recalcFenced=function(){this.row.recalc(),this.sLeft.scale(this.row.getHeight()/this.sLeft.getHeight()),this.sRight.scale(this.row.getHeight()/this.sRight.getHeight()),this.row.recalc(),this.setWidth(this.row.getWidth()),this.setHeight(this.row.getHeight()),this.setBaseline(this.row.getBaseline()),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToFenced(a,b)},this.moveContentToFenced=function(a,b){this.moveContentToBox(a,b),this.row.moveTo(a,b)},this.scale=function(a){this.row.scale(a),this.sLeft.scale(this.row.getHeight()/this.sLeft.getHeight()),this.sRight.scale(this.row.getHeight()/this.sRight.getHeight()),this.row.recalc,this.recalc()},this.toString=function(){return this.toStringBox()},e.length>0&&this.initFenced(a,b,c,d)},MathML.Fenced.prototype=new Box,Html.Em=function(a,b){Html.Em.arguments,Html.Em.length;this.className="Html.Em",this.initTextData(a,b)},Html.Em.prototype=new TextData,Html.A=function(a,b){Html.A.arguments,Html.A.length;this.className="Html.A",this.initTextData(a,b)},Html.A.prototype=new TextData,Html.Para=function(a,b){var c=Html.Para.arguments;Html.Para.length;this.className="Html.Para",this.children=null,this.lines=null,this.initPara=function(a,b){this.initCSSBox(),this.children=new Vector,this.lines=new Vector,this.addChild(a,b),this.setAttributes(b)},this.setColor=function(a){this.setColorBox(a);for(var b=this.getChildren();b.hasMoreElements();){var c=b.nextElement();c.setColor(a)}},this.getChildren=function(){return new Enumerator(this.children)},this.getLines=function(){return new Enumerator(this.lines)},this.setAttributes=function(a,b){this.setAttributesPara(a,b)},this.setAttributesPara=function(a,b){this.setAttributesBox(a,b),void 0!=a&&null!=a&&void 0!=a.text_align?this.text_align=a.text_align:this.text_align="left"},this.addChild=function(a,b){if(null==a)return!1;if("TextData"==a.className||"Html.Em"==a.className||"Html.A"==a.className){a.data=a.data.replace(/\n/gi,"");for(var c=a.data.split(" "),d=0;d<c.length;){if(0!=c[d].length){var e=new TextData(c[d]+" ",b);e.setColor(a.fColor),this.children.addElement(e)}d++}}else this.children.addElement(a)},this.paint=function(a,b,c){this.paintPara(a,b,c)},this.paintPara=function(a,b,c){this.paintBox(a,b,c);for(var d=this.getChildren();d.hasMoreElements();){var e=d.nextElement();e.paint(a,b,c)}},this.recalc=function(){this.recalcPara()},this.recalcPara=function(){var a=0,b=0,c=this.getInnerWidth(),d=new MathML.Row;this.lines.clear();for(var e=this.getChildren();e.hasMoreElements();){var f=e.nextElement();null!=f&&(f.recalc(),f.getWidth()+a>=c&&(a=0,b+=d.getHeight(),this.lines.addElement(d),d=new MathML.Row),a+=f.getWidth(),d.addChild(f))}this.lines.addElement(d),b+=d.getHeight(),this.setInnerHeight(b),this.setBaseline(b),this.recalcCSSBox()},this.moveContentTo=function(a,b){this.moveContentToPara(a,b)},this.moveContentToPara=function(a,b){this.moveContentToBox(a,b),a+=this.getDx(),b+=this.getDy();for(var c=(this.getInnerWidth(),0),d=this.getLines();d.hasMoreElements();){var e=d.nextElement();if(null!=e){switch(this.text_align){case"left":e.moveTo(a,b+c);break;case"right":e.moveTo(a+(w-e.getWidth()),b+c);break;case"center":e.moveTo(a+(w-e.getWidth())/2,b+c)}c+=e.getHeight()}}},this.toString=function(){return this.toStringBox()},c.length>0&&this.initPara(a,b)},Html.Para.prototype=new CSSBox,Html.Vertical=function(a){var b=Html.Vertical.arguments;Html.Vertical.length;this.className="Html.Vertical",this.children=null,this.initVertical=function(a){this.initCSSBox(),this.children=new Vector,this.addChild(a),this.setCSSBox(0,0,0,0,0,0,0,0,0,0,0,0)},this.getChildren=function(){return new Enumerator(this.children)},this.setAttributes=function(a,b){this.setAttributesPara(a,b)},this.setAttributesPara=function(a,b){this.setAttributesBox(a,b),void 0!=a&&null!=a&&void 0!=a.text_align?this.text_align=a.text_align:this.text_align="left"},this.addChild=function(a){return null==a?!1:void this.children.addElement(a)},this.paint=function(a,b,c){this.paintVertical(a,b,c)},this.paintVertical=function(a,b,c){this.paintBox(a,b,c);for(var d=this.getChildren();d.hasMoreElements();){var e=d.nextElement();e.paint(a,b,c)}},this.recalc=function(){this.recalcVertical()},this.recalcVertical=function(){for(var a=0,b=this.getInnerWidth(),c=this.getChildren();c.hasMoreElements();){var d=c.nextElement();null!=d&&(d.setWidth(b),d.recalc()),a+=d.getHeight()}this.setInnerHeight(a),this.setBaseline(a),this.recalcCSSBox()},this.moveContentTo=function(a,b){this.moveContentToVertical(a,b)},this.moveContentToVertical=function(a,b){this.moveContentToBox(a,b),a+=this.getDx(),b+=this.getDy();for(var c=0,d=this.getChildren();d.hasMoreElements();){var e=d.nextElement();null!=e&&(e.moveTo(a,b+c),c+=e.getHeight())}},this.toString=function(){return this.toStringBox()},b.length>0&&this.initVertical(a)},Html.Vertical.prototype=new CSSBox,Html.Image=function(a,b,c){var d=Html.Image.arguments;Html.Image.length;this.className="Html.Image",this.src=null,this.initImage=function(a,b,c){if(this.initBox(0,0,0,0),a instanceof Attributes){var d=a;return void this.setAttributes(d)}this.setWidth(parseFloat(b)||32),this.setHeight(parseFloat(c)||32),this.src=a},this.setAttributes=function(a,b){this.setAttributesImage(a,b)},this.setAttributesImage=function(a,b){this.setAttributesBox(a,b),void 0!=a&&null!=a&&(this.initImage(a.src,a.width,a.height),void 0!=a.alt&&(this.alt=a.alt))},this.createSVGContent=function(a,b,c){this.createSVGContentImage(a,b,c)},this.createSVGContentImage=function(a,b,c){this.createSVGContentBox(a,b,c),this.Node=a.drawImage(this.x,this.y,this.getWidth(),this.getHeight(),this.src)},this.recalc=function(){this.recalcImage()},this.recalcImage=function(){this.setBaseline(this.getHeight()),this.recalcBox()},this.moveContentTo=function(a,b){this.moveContentToImage(a,b)},this.moveContentToImage=function(a,b){null!=this.Node&&this.Node.translate(a,b)},this.toString=function(){return this.toStringBox()},d.length>0&&this.initImage(a,b,c)},Html.Image.prototype=new Box,Css.Parser=function(a){var b=Css.Parser.arguments;Css.Parser.length;this.className="Css.Parser",this.groupStyle=null,this.DELIM1="##DELIM1##",this.DELIM2="##DELIM2##",this.initParser=function(a){this.groupStyle=new Array,this.parseData(this.getEmbeddedStyle(a))},this.parseData=function(a){void 0==a&&(a=""),a=this.trim(this.removeComments(a));var b=a.split("}");b.pop();for(var c,d=0;d<b.length;d++){c=b[d].split("{");var e=c[0],f=c[1];this.groupStyle.push(new Css.GroupStyle(e,f))}},this.combine=function(a,b){for(var c in b)a[c]=b[c]},this.trim=function(a){return a.replace(/^\s*|\s*$/g,"")},this.whiteSpaceToSpaces=function(a){return a.replace(/\s+/g," ")},this.removeComments=function(a){return a=a.replace(/<!--/g,""),a=a.replace(/-->/g,""),a.replace(/\/\*(\r|\n|.)*\*\//g,"")},this.arrayContains=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1},this.arrayContainsEach=function(a,b){for(var c=!1,d=0;d<b.length;d++){c=!1;for(var e=0;e<a.length;e++)a[e]==b[d]&&(c=!0);if(!c)return!1}return!0},this.getEmbeddedStyle=function(a){var b=a.getElementsByTagName("style"),c="";if(b.length)for(var d=0;d<b.length;d++)c+=b.item(0).firstChild.data;return""==c?"":c},this.getInlineStyle=function(a){if(void 0==a||null==a)return"";var b=a.getAttribute("style");return void 0==b?"":b},this.previousSibling=function(a){var b=a.parentNode;if(void 0==b||!b.hasChildNodes())return!1;var c,d=!1,e=par.childNodes.length;for(c=0;e>c;c++){if(par.childNodes[c]==a)return d;d=par.childNodes[c]}return!1},this.getElementAttributeList=function(a,a){var b=new Array,c=elem.getAttribute(c);return c?(c=CSSParser.whiteSpaceToSpaces(c),b=c.split(" ")):b},this.getElementProperties=function(a,b){var c,d,e=this.groupStyle.length,f=new CSSProperties(elem.getAttribute("style"));for(c=0;e>c;c++)d=this.groupStyle[c].match(elem,b),d&&CSSParser.combine(f.values,d.values);return f.values},this.toString=function(){return this.className},b.length>0&&this.initParser(a)},Css.GroupStyle=function(a,b){var c=Css.GroupStyle.arguments;Css.GroupStyle.length;this.className="Css.GroupStyle",this.selectors=null,this.initGroupStyle=function(a,b){this.parseData(a,b)},this.parseData=function(a,b){this.selectors=a.split(",");for(var c=this.selectors.length,d=0;c>d;d++){var e=this.selectors[d];this.selectors[d]=new Css.SelectorDefinition(e,b)}},this.match=function(a,b){for(var c=this.selectors.length,d=0;c>d;d++)if(this.selectors[d].match(eleme,b))return this.selectors[d].properties;return!1},this.toString=function(){return this.className+"[ Selectors"+this.selectors+" ]"},c.length>0&&this.initGroupStyle(a,b)},Css.Properties=function(a){var b=Css.Properties.arguments;Css.Properties.length;this.className="Css.Properties",this.values=null,this.initProperties=function(a){this.values=new Hashtable,this.parseData(a)},this.parseData=function(a){if(void 0!=a)for(var b=a.split(";"),c=0;c<a.length;c++){var d=this.trim(b[c]);if(this.hasContent(d)){var e=d.split(":"),f=this.trim(e[0].toLowerCase()),g=this.trim(e[1].toLowerCase());this.hasContent(f)&&this.hasContent(g)&&this.values.put(f,g)}}},this.hasContent=function(a){return void 0!=a&&null!=a&&""!=a},this.trim=function(a){return void 0==a?"":a.replace(/^\s*|\s*$/g,"")},this.toString=function(){return this.className+" [ "+this.values.toString()+" ]"},b.length>0&&this.initProperties(a)},Css.SelectorDefinition=function(a,b){var c=Css.SelectorDefinition.arguments;Css.SelectorDefinition.length;this.className="Css.SelectorDefinition",this.data=null,this.singleSelectors=null,this.properties=null,this.initSelectorDefinition=function(a,b){this.data="",this.singleSelectors=new Array,this.properties=new Css.Properties(b),void 0!=b&&this.parseData(a)},this.parseData=function(a){return},this.toString=function(){return this.className},c.length>0&&this.initSelectorDefinition(a,b)},CSSSelectorDefinition.prototype.match=function(a,b){var c=this.singleSelectors.length-1,d=a,e=this.singleSelectors[c];if(!e.match(d,b))return!1;for(;d&&c>=0;){switch(e.combinator){case" ":c--,e=this.singleSelectors[c];do d=d.parentNode;while(d&&!e.match(d,b));if(!d)return!1;break;case">":if(c--,e=this.singleSelectors[c],d=d.parentNode,!e.match(d,b))return!1;break;case"+":if(c--,e=this.singleSelectors[c],d=CSSParser.previousSibling(d),!e.match(d,b))return!1;break;default:return c?!1:this.properties}b&&(b=null)}return!1},Browserjs.prototype=new Node,Browserjs.Document=function(a,b){var c=Browserjs.Document.arguments;Browserjs.Document.length;this.className="Browserjs.Document",this.root=null,this.iClass=null,this.browser=null,this.created=!1,this.bgGraphics=null,this.fgGraphics=null,this.firstText=null,this.bodyBox=null,this.initDocument=function(a,b){this.root=a,this.browser=b,this.obtainContainerSettings(this.root)},this.obtainContainerSettings=function(a){for(;a&&("xhtml:html"==a.nodeName||"foreignObject"==a.nodeName||"switch"==a.nodeName);)a=a.parentNode;var b="rect"==a.nodeName,c=b?parseFloat(a.getAttribute("x")):0,d=b?parseFloat(a.getAttribute("y")):0,e=b?parseFloat(a.getAttribute("width")):250,f=b?parseFloat(a.getAttribute("height")):250;this.initNode(c,d,e,f,0,1),this.iClass=a.getAttribute("class");var g=a.getAttribute("stroke-width")||0,h=parseFloat(g)/2;this.setCoord(c+h,d+h),this.setSize(e-2*h+1,f-2*h+1)},this.draw=function(a){this.paint(a)},this.paint=function(a){this.created||(this.created=!0,this.createSVGContent(a),this.bodyBox=this.parse(),this.bodyBox.setSize(this.getWidth(),this.getHeight()),this.bodyBox.draw(0,0,this.fgGraphics,this.bgGraphics,this.firstText)),void 0!=a&&null!=this.getNode()&&a.addGraphics(this.getNode())},this.createSVGContent=function(a){var a=new Graphics(this.x,this.y,this.w,this.h);this.bgGraphics=new Graphics(0,0,this.w,this.h),this.fgGraphics=new Graphics(0,0,this.w,this.h),this.firstText=this.fgGraphics.drawText(0,0,""),a.addGraphics(this.bgGraphics),a.addGraphics(this.fgGraphics),this.Node=a.getNode()},this.recalc=function(){null!=this.bodyBox&&this.bodyBox.recalc()},this.parse=function(a){a=a||this.root.getElementsByTagName("body").item(0);var b=null,c=a.childNodes;if(0==c.length)return this.boxesFactory(a,0,b);b=new Array;for(var d=0,e=0;d<c.length;d++){var f=this.parse(c.item(d));null!=f&&(b[e++]=f)}return this.boxesFactory(a,b.length,b)},this.boxesFactory=function(a,b,c){var d="#text"!=a.nodeName?new Attributes(a):null;if(0==b)switch(a.nodeName){case"img":return new Html.Image(d);case"mo":return new MathML.Mo(a.firstChild.data,d);case"mi":return new MathML.Mi(a.firstChild.data,d);case"mn":return new MathML.Mn(a.firstChild.data,d);case"#text":switch(a.parentNode.nodeName){case"p":return new TextData(a.data,d)}}if("p"==a.nodeName){for(var e=new Html.Para(c[0],d),f=1;b>f;f++)e.addChild(c[f]);return e}if("xhtml:html"==a.nodeName||"body"==a.nodeName||"table"==a.nodeName||"head"==a.nodeName){for(var e=new Html.Vertical(c[0]),f=1;b>f;f++)e.addChild(c[f]);return e}if("mrow"==a.nodeName||"msqrt"==a.nodeName||"math:math"==a.nodeName||"mfenced"==a.nodeName){for(var e=new MathML.Row,f=0;b>f;f++)e.addChild(c[f]);return"msqrt"==a.nodeName?new MathML.Sqrt(e):e}switch(a.nodeName){case"msup":return new MathML.Sup(c[0],c[1],d);case"msub":return new MathML.Sub(c[0],c[1],d);case"msubsup":return new MathML.Subsup(c[0],c[1],c[2],d);case"mover":return new MathML.Over(c[0],c[1],d);case"munder":return new MathML.Under(c[0],c[1],d);case"munderover":return new MathML.UnderOver(c[0],c[1],c[2],d);case"mfrac":return new MathML.Frac(c[0],c[1],d)}if("p"==a.nodeName||"li"==a.nodeName||"h1"==a.nodeName||"h2"==a.nodeName||"h3"==a.nodeName||"td"==a.nodeName||"th"==a.nodeName){for(var e=new TextData(c[0],d),f=1;f<n;f++)e.addChild(c[f],d);return e}},this.toString=function(){return this.className+"[x:"+this.x+",y:"+this.y+",w:"+this.w+",h:"+this.h+"]"},c.length>0&&this.initDocument(a,b)},Browserjs.Document.prototype=new Node;